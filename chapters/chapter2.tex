% Chapter x
% Contains The proof for Theorem 3 (Z -> W)

\chapter{The breadth-first-walk on the random graph}
\todo{Update title}

For ease of notation, we will drop the superscript $t$ from all random variables.

\begin{lemma} \label{lemma decomp Zn}
	The decomposition 
	\begin{equation} \label{decomp Zn}
	Z_n = M_n + A_n
	\end{equation}
	holds, where $M_n$ is a martingale and $A_n$ is defined by
	\begin{equation} \label{def An}
	\An{t} = \int_{0}^{t} a_n(s)ds - t
	\end{equation}
	and
	\begin{equation} \label{def an}
	a_n(s)ds = P(\text{A new edge appears in} \enspace [s, s+ds] \cond \Zn{u}, \enspace u \leq s).
	\end{equation}	
\end{lemma}
\todo{Make text in P() not cursive?}

\begin{note}
	$A_n$ is a continous process of bounded variation, so jumps of $M_n$ are the same as jumps of $Z_n$. Since $Z_n$ and $A_n$ are of bounded variation, $M_n$ is a cadlaq process of bounded variation.	
\end{note}
\todo{Proof An of bounded variation}
\todo{Proof Mn cadlaq}

\begin{proof}
	We will prove that, for $A_n$ defined in \ref{def An} and \ref{def an},
	$Z_n - A_n$
	is a martingale by showing that
	\begin{equation} \label{Mn martingale}
	\Exp{ \Zn{t+u} - \An{t+u} \cond \F{t} } = \Zn{t} - \An{t} \quad \forall u \geq 0
	\end{equation}
	holds, where $\F{t}$ is the natural $\sigma$-algebra generated by $Z_n$, 
	$\F{t} = \sigma(\Zn{s}, s \leq t).$
	This is equivalent to 
	\begin{equation}
	\Exp{\Zn{t+u} - \Zn{t} \cond \F{t}} = \Exp{\An{t+u} - \An{t} \cond \F{t}}.
	\end{equation}
	
	We start with the left-hand side. 
	The difference between $Z_n$ at times $t$ and $t+u$ is the sum of all jumps that occurred in $[t, t+u]$ minus the constant downward drift $u$:
	\begin{align*}
	\Exp{\Zn{t+u} - \Zn{t} \cond \F{t}} 
	&= \Exp{\text{Number of jumps in} \enspace [t, t+u] \cond \F{t}} - u \\
	&= \Exp{\text{Number of new edges appearing in} \enspace [t, t+u] \cond \F{t}} - u,
	\end{align*}
	since every new edge corresponds to a jump of size $1$ in $Z_n$.
	
	Looking at the right-hand side, we define $\Esds$ as the event of a new edge appearing in the interval $[s,s+ds]$ and calculate
	\begin{align*}
	\Exp{\An{t+u} - \An{t} \cond \F{t}}
	&= \Exp{ \int_{0}^{t+u} a_n(s)ds - (t+u) - \int_{0}^{t} a_n(s)ds + t \cond \F{t} } \\
	&= \Exp{ \int_{t}^{t+u} a_n(s)ds \cond \F{t} } - u \\
	&= \int_{t}^{t+u} \Exp{a_n(s)ds \cond \F{t}} - u \\
	&= \int_{t}^{t+u} \Exp{ P(\Esds \cond \F{s}) \cond \F{t} } - u\\
	&= \int_{t}^{t+u} P( \Esds \cond \F{t} ) - u
	\quad \text{since} \enspace \F{s} \subseteq \F{t} \enspace \forall s \in [t,t+u] \\
	&= \Exp{\text{Number of new edges appearing in} \enspace [t, t+u] \cond \F{t}} - u.
	\end{align*}
	\todo{Fs in Ft or Ft in Fs?}
	\todo{Number of new edges more detailed.}
	
	This proves $M_n$ to be a martingale. 	
\end{proof}

\begin{lemma} \label{lemma decomp Mn}
	The decomposition
	\begin{equation} \label{decomp Mn}
	M_n^2 = Q_n + B_n
	\end{equation}
	holds where $Q_n$ is a martingale and $B_n$ is defined by 
	\begin{equation} \label{def An}
	\Bn{t} = \int_{0}^{t} a_n(s)ds = A_n(t) + t
	\end{equation}
	with $a_n$ defined in \ref{def an}.
\end{lemma}
\begin{note}
	$B_n$ is a continuous process.
\end{note}
\begin{proof}
	We will prove that
	$M_n^2 - B_n$
	is a martingale.
	Since $M_n$ is a right-continuous process of bounded variation, its quadratic variation
	\begin{equation*} \label{def quadratic variation}
	[M]_t := \limsup \sum (M_{t_i} - M_{t_{i-1}})^2
	\end{equation*}
	\todo{Add definition of quadratic variation}
	is
	\begin{equation} \label{quadratic variation Mn}
	\Mnq{t} = \sum_{0 \leq s \leq t} (\Delta \Mn{s})^2,
	\end{equation}
	where
	$\Delta \Mn{s} := \Mn{s} - \Mn{s-}$ 
	can take one of two values: $1$ if there is a jump of $1$ at time $s$, 0 otherwise.
	\todo{Other word for "take"}
	We refer to [EK] to see that
	$M_n^2 - [M_n]$
	is a martingale.
	\todo{Add reference}
	\todo{Nicer sentence}
	Thus
	\begin{equation}
	M_n^2 - B_n = (\underbrace{M_n^2 - [M_n]}_{\text{martingale}}) + ([M_n] - B_n)
	\end{equation}
	and to prove \ref{decomp Mn} it suffices to show that
	$[M_n] - B_n$
	is a martingale.
	Using the fact that the jumps of $M_n$ are the jumps of $Z_n$ and
	$\Delta Z_n \in \lbrace0,1 \rbrace$
	we calculate
	\begin{align*}
	\Mnq{t} - \Bn{t}
	&= \sum_{0 \leq s \leq t} (\Delta \Mn{s})^2 - \Bn{t} \\
	&= \sum_{0 \leq s \leq t} (\Delta \Zn{s})^2 - \Bn{t} \\
	&= \sum_{0 \leq s \leq t} \Delta \Zn{s} - \Bn{t} \\
	&= \text{Number of jumps of} \enspace Z_n \enspace \text{in} \enspace [0,t] - \Bn{t} \\
	&= (\text{Number of jumps of} \enspace Z_n \enspace \text{in} \enspace [0,t] - t) - \An{t} \\
	&= \Zn{t} - \An{t}
	\end{align*}
	which is a martingale from Lemma \ref{lemma decomp Zn}.
	
\end{proof}






















